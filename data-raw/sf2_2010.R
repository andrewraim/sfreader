library(readr)
library(dplyr)
library(stringr)
library(tibble)

# TBD: Can we remove this now?
# src_path = "C:/Users/raim0001/Documents/datasets/sf2_2010"

# TBD: is there a more portable way to add data to a package?
dest_path = sprintf("%s/%s", getwd(), "data")

# TBD: Can we remove this now?
# The following files come from SF2_MSAccess_2007.accdb, which is
# provided along with the dataset. I can't directly read Access DBs from
# R (I think I'm missing an ODBC driver), so I opened it in Access, and
# exported each table to a CSV. Then I read the CSVs here and save them
# to R datasets.

# ----- Geo file: fixed width format -----
sf2_2010_geo_cols = tribble(
     ~ID,     ~FIELD, ~START_POS, ~FIELD_SIZE, ~DATA_TYPE, ~DESCRIPTION,
      3L,   "FILEID",         1L,          6L,        "c",  "File Identification",
      4L,   "STUSAB",         7L,          2L,        "c",  "State/US-Abbreviation (USPS)",
      5L,   "SUMLEV",         9L,          3L,        "c",  "Summary Level",
      6L,  "GEOCOMP",        12L,          2L,        "c",  "Geographic Component",
      7L, "CHARITER",        14L,          3L,        "c",  "Characteristic Iteration",
      8L,    "CIFSN",        17L,          2L,        "c",  "Characteristic Iteration File Sequence Number",
      9L, "LOGRECNO",        19L,          7L,        "c",  "Logical Record Number",
     10L,   "REGION",        26L,          1L,        "c",  "Region",
     11L, "DIVISION",        27L,          1L,        "c",  "Division",
     12L,    "STATE",        28L,          2L,        "c",  "State (FIPS)",
     13L,   "COUNTY",        30L,          3L,        "c",  "County",
     14L, "COUNTYCC",        33L,          2L,        "c",  "FIPS County Class Code",
     15L, "COUNTYSC",        35L,          2L,        "c",  "County Size Code",
     16L,   "COUSUB",        37L,          5L,        "c",  "County Subdivision (FIPS)",
     17L, "COUSUBCC",        42L,          2L,        "c",  "FIPS County Subdivision Class Code",
     18L, "COUSUBSC",        44L,          2L,        "c",  "County Subdivision Size Code",
     19L,    "PLACE",        46L,          5L,        "c",  "Place (FIPS)",
     20L,  "PLACECC",        51L,          2L,        "c",  "FIPS Place Class Code",
     21L,  "PLACESC",        53L,          2L,        "c",  "Place Size Code",
     22L,    "TRACT",        55L,          6L,        "c",  "Census Tract",
     23L,   "BLKGRP",        61L,          1L,        "c",  "Block Group",
     24L,    "BLOCK",        62L,          4L,        "c",  "Block",
     25L,      "IUC",        66L,          2L,        "c",  "Internal Use Code",
     26L,   "CONCIT",        68L,          5L,        "c",  "Consolidated City (FIPS)",
     27L, "CONCITCC",        73L,          2L,        "c",  "FIPS Consolidated City Class Code",
     28L, "CONCITSC",        75L,          2L,        "c",  "Consolidated City Size Code",
     29L,   "AIANHH",        77L,          4L,        "c",  "American Indian Area/Alaska Native Area/Hawaiian Home Land (Census)",
     30L, "AIANHHFP",        81L,          5L,        "c",  "American Indian Area/Alaska Native Area/Hawaiian Home Land (FIPS)",
     31L, "AIANHHCC",        86L,          2L,        "c",  "FIPS American Indian Area/Alaska Native Area/Hawaiian Home Land Class Code",
     32L,  "AIHHTLI",        88L,          1L,        "c",  "American Indian Trust Land/Hawaiian Home Land Indicator",
     33L,   "AITSCE",        89L,          3L,        "c",  "American Indian Tribal Subdivision (Census)",
     34L,     "AITS",        92L,          5L,        "c",  "American Indian Tribal Subdivision (FIPS)",
     35L,   "AITSCC",        97L,          2L,        "c",  "FIPS American Indian Tribal Subdivision Class Code",
     36L,   "TTRACT",        99L,          6L,        "c",  "Tribal Census Tract",
     37L,  "TBLKGRP",       105L,          1L,        "c",  "Tribal Block Group",
     38L,     "ANRC",       106L,          5L,        "c",  "Alaska Native Regional Corporation (FIPS)",
     39L,   "ANRCCC",       111L,          2L,        "c",  "FIPS Alaska Native Regional Corporation Class Code",
     40L,     "CBSA",       113L,          5L,        "c",  "Metropolitan Statistical Area/Micropolitan Statistical Area",
     41L,   "CBSASC",       118L,          2L,        "c",  "Metropolitan Statistical Area/Micropolitan Statistical Area Size Code",
     42L,   "METDIV",       120L,          5L,        "c",  "Metropolitan Division",
     43L,      "CSA",       125L,          3L,        "c",  "Combined Statistical Area",
     44L,    "NECTA",       128L,          5L,        "c",  "New England City and Town Area",
     45L,  "NECTASC",       133L,          2L,        "c",  "New England City and Town Area Size Code",
     46L, "NECTADIV",       135L,          5L,        "c",  "New England City and Town Area Division",
     47L,   "CNECTA",       140L,          3L,        "c",  "Combined New England City and Town Area",
     48L,  "CBSAPCI",       143L,          1L,        "c",  "Metropolitan Statistical Area/Micropolitan Statistical Area Principal City Indicator",
     49L, "NECTAPCI",       144L,          1L,        "c",  "New England City and Town Area Principal City Indicator",
     50L,       "UA",       145L,          5L,        "c",  "Urban Area",
     51L,     "UASC",       150L,          2L,        "c",  "Urban Area Size Code",
     52L,   "UATYPE",       152L,          1L,        "c",  "Urban Area Type",
     53L,       "UR",       153L,          1L,        "c",  "Urban/Rural",
     54L,       "CD",       154L,          2L,        "c",  "Congressional District (111th)",
     55L,     "SLDU",       156L,          3L,        "c",  "State Legislative District (Upper Chamber) (Year 1)",
     56L,     "SLDL",       159L,          3L,        "c",  "State Legislative District (Lower Chamber) (Year 1)",
     57L,      "VTD",       162L,          6L,        "c",  "Voting District",
     58L,     "VTDI",       168L,          1L,        "c",  "Voting District Indicator",
     59L, "RESERVE2",       169L,          3L,        "c",  "Reserved",
     60L,    "ZCTA5",       172L,          5L,        "c",  "ZIP Code Tabulation Area (5-Digit)",
     61L,   "SUBMCD",       177L,          5L,        "c",  "Subminor Civil Division (FIPS)",
     62L, "SUBMCDCC",       182L,          2L,        "c",  "FIPS Subminor Civil Division Class Code",
     63L,    "SDELM",       184L,          5L,        "c",  "School District (Elementary)",
     64L,    "SDSEC",       189L,          5L,        "c",  "School District (Secondary)",
     65L,    "SDUNI",       194L,          5L,        "c",  "School District (Unified)",
     66L, "AREALAND",       199L,         14L,        "d",  "Area (Land)",
     67L, "AREAWATR",       213L,         14L,        "d",  "Area (Water)",
     68L,     "NAME",       227L,         90L,        "c",  "Area Name-Legal/Statistical Area Description (LSAD) Term-Part Indicator",
     69L, "FUNCSTAT",       317L,          1L,        "c",  "Functional Status Code",
     70L,    "GCUNI",       318L,          1L,        "c",  "Geographic Change User Note Indicator",
     71L,   "POP100",       319L,          9L,        "c",  "Population Count (100%)",
     72L,    "HU100",       328L,          9L,        "c",  "Housing Unit Count (100%)",
     73L, "INTPTLAT",       337L,         11L,        "c",  "Internal Point (Latitude)",
     74L, "INTPTLON",       348L,         12L,        "c",  "Internal Point (Longitude)",
     75L,    "LSADC",       360L,          2L,        "c",  "Legal/Statistical Area Description Code",
     76L, "PARTFLAG",       362L,          1L,        "c",  "Part Flag",
     77L, "RESERVE3",       363L,          6L,        "c",  "Reserved",
     78L,      "UGA",       369L,          5L,        "c",  "Urban Growth Area",
     79L,  "STATENS",       374L,          8L,        "c",  "State (ANSI)",
     80L, "COUNTYNS",       382L,          8L,        "c",  "County (ANSI)",
     81L, "COUSUBNS",       390L,          8L,        "c",  "County Subdivision (ANSI)",
     82L,  "PLACENS",       398L,          8L,        "c",  "Place (ANSI)",
     83L, "CONCITNS",       406L,          8L,        "c",  "Consolidated City (ANSI)",
     84L, "AIANHHNS",       414L,          8L,        "c",  "American Indian Area/Alaska Native Area/Hawaiian Home Land (ANSI)",
     85L,   "AITSNS",       422L,          8L,        "c",  "American Indian Tribal Subdivision (ANSI)",
     86L,   "ANRCNS",       430L,          8L,        "c",  "Alaska Native Regional Corporation (ANSI)",
     87L, "SUBMCDNS",       438L,          8L,        "c",  "Subminor Civil Division (ANSI)",
     88L,    "CD113",       446L,          2L,        "c",  "Congressional District (113th)",
     89L,    "CD114",       448L,          2L,        "c",  "Congressional District (114th)",
     90L,    "CD115",       450L,          2L,        "c",  "Congressional District (115th)",
     91L,    "SLDU2",       452L,          3L,        "c",  "State Legislative District (Upper Chamber) (Year 2)",
     92L,    "SLDU3",       455L,          3L,        "c",  "State Legislative District (Upper Chamber) (Year 3)",
     93L,    "SLDU4",       458L,          3L,        "c",  "State Legislative District (Upper Chamber) (Year 4)",
     94L,    "SLDL2",       461L,          3L,        "c",  "State Legislative District (Lower Chamber) (Year 2)",
     95L,    "SLDL3",       464L,          3L,        "c",  "State Legislative District (Lower Chamber) (Year 3)",
     96L,    "SLDL4",       467L,          3L,        "c",  "State Legislative District (Lower Chamber) (Year 4)",
     97L, "AIANHHSC",       470L,          2L,        "c",  "American Indian Area/Alaska Native Area/Hawaiian Home Land Size Code",
     98L,    "CSASC",       472L,          2L,        "c",  "Combined Statistical Area Size Code",
     99L, "CNECTASC",       474L,          2L,        "c",  "Combined NECTA Size Code",
    100L,     "MEMI",       476L,          1L,        "c",  "Metropolitan/Micropolitan Indicator",
    101L,    "NMEMI",       477L,          1L,        "c",  "NECTA Metropolitan/Micropolitan Indicator",
    102L,     "PUMA",       478L,          5L,        "c",  "Public Use Microdata Area",
    103L, "RESERVED",       483L,         18L,        "c",  "Reserved"
)
# ff = sprintf("%s/%s", src_path, "GeoHeader_Specifications.csv")
# col_types = cols(ID = col_integer(), `FIELD SIZE` = col_integer(), `STARTING POSITION` = col_integer())
# sf2_2010_geo_cols = read_csv(ff, col_types = col_types)
dest_file = sprintf("%s/%s.rda", dest_path, "sf2_2010_geo_cols")
save(sf2_2010_geo_cols, file = dest_file)

# ----- Characteristic iterations -----
sf2_2010_iterations = tribble(
	~CODE, ~DESCRIPTION,
	"001", "Total Population",
	"002", "White alone",
	"003", "White alone or in combination with one or more other races",
	"004", "Black or African American alone",
	"005", "Black or African American alone or in combination with one or more other races",
	"006", "American Indian and Alaska Native alone (300, A01-Z99)",
	"009", "American Indian and Alaska Native alone or in combination with one or more other races (300, A01-Z99) & (100-299) or (300, A01-Z99) or (400-999)",
	"012", "Asian alone (400-499)",
	"013", "Asian Indian alone (400-401)",
	"014", "Bangladeshi alone (402)",
	"015", "Cambodian alone (405-409)",
	"016", "Chinese alone (410-419)",
	"017", "Chinese (except Taiwanese) alone (410-411)",
	"018", "Taiwanese alone (412-419)",
	"019", "Filipino alone (420-421)",
	"020", "Hmong alone (422)",
	"021", "Indonesian alone (423-429)",
	"022", "Japanese alone (430-439)",
	"023", "Korean alone (440-441)",
	"024", "Laotian alone (442)",
	"025", "Malaysian alone (443)",
	"026", "Pakistani alone (445)",
	"027", "Sri Lankan alone (446)",
	"028", "Thai alone (447-449)",
	"029", "Vietnamese alone (450-459)",
	"031", "Asian alone or in combination with one or more other races  (400-499) & (100-299) or (300, A01-Z99) or (400-999)",
	"032", "Asian Indian alone or in any combination (400-401) & (100-299) or (300, A01-Z99) or (400-999)",
	"033", "Bangladeshi alone or in any combination (402) & (100-299) or (300, A01-Z99) or (400-999)",
	"034", "Cambodian alone or in any combination (405-409) & (100-299) or (300, A01-Z99) or (400-999)",
	"035", "Chinese alone or in any combination (410-419) & (100-299) or (300, A01-Z99) or (400-999)",
	"036", "Chinese (except Taiwanese) alone or in any combination (410-411) & (100-299) or (300, A01-Z99) or (400-999)",
	"037", "Taiwanese alone or in any combination (412-419) & (100-299) or (300, A01-Z99) or (400-999)",
	"038", "Filipino alone or in any combination (420-421) & (100-299) or (300, A01-Z99) or (400-999)",
	"039", "Hmong alone or in any combination (422) & (100-299) or (300, A01-Z99) or (400-999)",
	"040", "Indonesian alone or in any combination (423-429) & (100-299) or (300, A01-Z99) or (400-999)",
	"041", "Japanese alone or in any combination (430-439) & (100-299) or (300, A01-Z99) or (400-999)",
	"042", "Korean alone or in any combination (440-441) & (100-299) or (300, A01-Z99) or (400-999)",
	"043", "Laotian alone or in any combination (442) & (100-299) or (300, A01-Z99) or (400-999)",
	"044", "Malaysian alone or in any combination (443) & (100-299) or (300, A01-Z99) or (400-999)",
	"045", "Pakistani alone or in any combination (445) & (100-299) or (300, A01-Z99) or (400-999)",
	"046", "Sri Lankan alone or in any combination (446) & (100-299) or (300, A01-Z99) or (400-999)",
	"047", "Thai alone or in any combination (447-449) & (100-299) or (300, A01-Z99) or (400-999)",
	"048", "Vietnamese alone or in any combination (450-459) & (100-299) or (300, A01-Z99) or (400-999)",
	"050", "Native Hawaiian and Other Pacific Islander alone (500-599)",
	"051", "Polynesian alone (500-519)",
	"052", "Native Hawaiian alone (500-503)",
	"053", "Samoan alone (510-511)",
	"054", "Tongan alone (513)",
	"055", "Micronesian alone (520-529, 531-541)",
	"056", "Guamanian or Chamorro alone (520-522)",
	"057", "Melanesian alone (542-546)",
	"058", "Fijian alone (542)",
	"060", "Native Hawaiian and Other Pacific Islander alone or in combination with one or more other races  (500-599) & (100-299) or (300, A01-Z99) or (400-999):",
	"061", "Polynesian alone or in any combination (500-519) & (100-299) or (300, A01-Z99) or (400-999):",
	"062", "Native Hawaiian alone or in any combination (500-503) & (100-299) or (300, A01-Z99) or (400-999)",
	"063", "Samoan alone or in any combination (510-511) & (100-299) or (300, A01-Z99) or (400-999)",
	"064", "Tongan alone or in any combination (513) & (100-299) or (300, A01-Z99) or (400-999)",
	"065", "Micronesian alone or in any combination (520-529, 531-541) & (100-299) or (300, A01-Z99) or (400-999)",
	"066", "Guamanian or Chamorro alone or in any combination (520-522) & (100-299) or (300, A01-Z99) or (400-999)",
	"067", "Melanesian alone or in any combination (542-546) & (100-299) or (300, A01-Z99) or (400-999)",
	"068", "Fijian alone or in any combination (542) & (100-299) or (300, A01-Z99) or (400-999)",
	"070", "Some Other Race alone",
	"071", "Some Other Race alone or in combination with one or more other races",
	"072", "Bhutanese alone (403)",
	"073", "Burmese alone (404)",
	"075", "Mongolian alone (465)",
	"076", "Nepalese alone (472)",
	"077", "Okinawan alone (444)",
	"078", "Singaporean alone (473)",
	"080", "Bhutanese alone or in any combination (403) & (100-299) or (300, A01-Z99) or (400-999)",
	"081", "Burmese alone or in any combination (404) & (100-299) or (300, A01-Z99) or (400-999)",
	"082", "Maldivian alone or in any combination (471) & (100-299) or (300, A01-Z99) or (400-999)",
	"083", "Mongolian alone or in any combination (465) & (100-299) or (300, A01-Z99) or (400-999)",
	"084", "Nepalese alone or in any combination (472) & (100-299) or (300, A01-Z99) or (400-999)",
	"085", "Okinawan alone or in any combination (444) & (100-299) or (300, A01-Z99) or (400-999)",
	"086", "Singaporean alone or in any combination (473) & (100-299) or (300, A01-Z99) or (400-999)",
	"088", "Tahitian alone (512)",
	"089", "Tokelauan alone (515)",
	"091", "Carolinian alone (534)",
	"092", "Chuukese alone (540)",
	"093", "I-Kiribati alone (539)",
	"094", "Kosraean alone (535)",
	"095", "Mariana Islander alone (531)",
	"096", "Marshallese alone (532)",
	"097", "Palauan alone (533)",
	"098", "Pohnpeian alone (537)",
	"099", "Saipanese alone (538)",
	"100", "Two or More Races",
	"101", "Two races with Some Other Race",
	"103", "Two races without Some Other Race",
	"104", "Three or more races",
	"105", "White; Black or African American",
	"106", "White; American Indian and Alaska Native",
	"107", "White; Asian",
	"108", "White; Native Hawaiian and Other Pacific Islander",
	"109", "White; Some Other Race",
	"110", "Black or African American; American Indian and Alaska Native",
	"111", "Black or African American; Asian",
	"112", "Black or African American; Native Hawaiian and Other Pacific Islander",
	"113", "Black or African American; Some Other Race",
	"114", "American Indian and Alaska Native; Asian",
	"115", "American Indian and Alaska Native; Native Hawaiian and Other Pacific Islander",
	"116", "American Indian and Alaska Native; Some Other Race",
	"117", "Asian; Native Hawaiian and Other Pacific Islander",
	"118", "Asian; Some Other Race",
	"119", "Native Hawaiian and Other Pacific Islander; Some Other Race",
	"120", "White; Black or African American; American Indian and Alaska Native",
	"121", "White; Black or African American; Asian",
	"122", "White; Black or African American; Native Hawaiian and Other Pacific Islander",
	"123", "White; Black or African American; Some Other Race",
	"124", "White; American Indian and Alaska Native; Asian",
	"125", "White; American Indian and Alaska Native; Native Hawaiian and Other Pacific Islander",
	"126", "White; American Indian and Alaska Native; Some Other Race",
	"127", "White; Asian; Native Hawaiian and Other Pacific Islander",
	"128", "White; Asian; Some Other Race",
	"129", "White; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"130", "Black or African American; American Indian and Alaska Native; Asian",
	"131", "Black or African American; American Indian and Alaska Native; Native Hawaiian and Other Pacific Islander",
	"132", "Black or African American; American Indian and Alaska Native; Some Other Race",
	"133", "Black or African American; Asian; Native Hawaiian and Other Pacific Islander",
	"134", "Black or African American; Asian; Some Other Race",
	"135", "Black or African American; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"136", "American Indian and Alaska Native; Asian; Native Hawaiian and Other Pacific Islander",
	"137", "American Indian and Alaska Native; Asian; Some Other Race",
	"138", "American Indian and Alaska Native; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"139", "Asian; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"140", "White; Black or African American; American Indian and Alaska Native; Asian",
	"141", "White; Black or African American; American Indian and Alaska Native; Native Hawaiian and Other Pacific Islander",
	"142", "White; Black or African American; American Indian and Alaska Native; Some Other Race",
	"143", "White; Black or African American; Asian; Native Hawaiian and Other Pacific Islander",
	"144", "White; Black or African American; Asian; Some Other Race",
	"145", "White; Black or African American; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"146", "White; American Indian and Alaska Native; Asian; Native Hawaiian and Other Pacific Islander",
	"147", "White; American Indian and Alaska Native; Asian; Some Other Race",
	"148", "White; American Indian and Alaska Native; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"149", "White; Asian; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"150", "Black or African American; American Indian and Alaska Native; Asian; Native Hawaiian and Other Pacific Islander",
	"151", "Black or African American; American Indian and Alaska Native; Asian; Some Other Race",
	"152", "Black or African American; American Indian and Alaska Native; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"153", "Black or African American; Asian; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"154", "American Indian and Alaska Native; Asian; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"155", "White; Black or African American; American Indian and Alaska Native; Asian; Native Hawaiian and Other Pacific Islander",
	"156", "White; Black or African American; American Indian and Alaska Native; Asian; Some Other Race",
	"157", "White; Black or African American; American Indian and Alaska Native; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"158", "White; Black or African American; Asian; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"159", "White; American Indian and Alaska Native; Asian; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"160", "Black or African American; American Indian and Alaska Native; Asian; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"161", "White; Black or African American; American Indian and Alaska Native; Asian; Native Hawaiian and Other Pacific Islander; Some Other Race",
	"162", "Yapese alone (541)",
	"164", "Papua New Guinean alone (544)",
	"168", "Tahitian alone or in any combination (512) & (100-299) or (300, A01-Z99) or (400-999)",
	"169", "Tokelauan alone or in any combination (515) & (100-299) or (300, A01-Z99) or (400-999)",
	"171", "Carolinian alone or in any combination (534) & (100-299) or (300, A01-Z99) or (400-999)",
	"172", "Chuukese alone or in any combination (540) & (100-299) or (300, A01-Z99) or (400-999)",
	"173", "I-Kiribati alone or in any combination (539) & (100-299) or (300, A01-Z99) or (400-999)",
	"174", "Kosraean alone or in any combination (535) & (100-299) or (300, A01-Z99) or (400-999)",
	"175", "Mariana Islander alone or in any combination (531) & (100-299) or (300, A01-Z99) or (400-999)",
	"176", "Marshallese alone or in any combination (532) & (100-299) or (300, A01-Z99) or (400-999)",
	"177", "Palauan alone or in any combination (533) & (100-299) or (300, A01-Z99) or (400-999)",
	"178", "Pohnpeian alone or in any combination (537) & (100-299) or (300, A01-Z99) or (400-999)",
	"179", "Saipanese alone or in any combination (538) & (100-299) or (300, A01-Z99) or (400-999)",
	"180", "Yapese alone or in any combination (541) & (100-299) or (300, A01-Z99) or (400-999)",
	"182", "Papua New Guinean alone or in any combination (544) & (100-299) or (300, A01-Z99) or (400-999)",
	"183", "Solomon Islander alone or in any combination (545) & (100-299) or (300, A01-Z99) or (400-999)",
	"187", "Alaska Native tribes, specified, alone (M52-R98, S01-S99)",
	"188", "Inupiat alone (N67-P29, P33-P37)",
	"189", "Tsimshian alone (N56-N58)",
	"190", "Yup'ik alone (P30-P32, P38-R10)",
	"193", "American Indian tribes, specified, alone or in any combination (A01-M38, T01-Z99) & (100-299) or (300, A01-Z99) or (400-999)",
	"194", "Arapaho alone or in any combination (A24-A33) & (100-299) or (300, A01-Z99) or (400-999)",
	"195", "Assiniboine Sioux alone or in any combination (A38-A44) & (100-299) or (300, A01-Z99) or (400-999)",
	"196", "Canadian and French American Indian alone or in any combination (T01-V23) & (100-299) or (300, A01-Z99) or (400-999)",
	"197", "Central American Indian alone or in any combination (V24-V83) & (100-299) or (300, A01-Z99) or (400-999)",
	"198", "Chippewa Cree alone or in any combination (C01-C04) & (100-299) or (300, A01-Z99) or (400-999)",
	"199", "Chumash alone or in any combination (C20-C24) & (100-299) or (300, A01-Z99) or (400-999)",
	"200", "Alaskan Athabascan alone (M52-N27)",
	"201", "Alaskan Athabascan alone or in any combination (M52-N27) & (100-299) or (300, A01-Z99) or (400-999)",
	"202", "Aleut alone (R11-R98, S01-S99)",
	"203", "Aleut alone or in any combination (R11-R98, S01-S99) & (100-299) or (300, A01-Z99) or (400-999)",
	"204", "Apache alone (A09-A23)",
	"205", "Apache alone or in any combination (A09-A23) & (100-299) or (300, A01-Z99) or (400-999)",
	"206", "Blackfeet alone (A45-A50)",
	"207", "Blackfeet alone or in any combination (A45-A50) & (100-299) or (300, A01-Z99) or (400-999)",
	"210", "Cheyenne alone (B40-B45)",
	"211", "Cheyenne alone or in any combination (B40-B45) & (100-299) or (300, A01-Z99) or (400-999)",
	"212", "Chickasaw alone (B53-B56)",
	"213", "Chickasaw alone or in any combination (B53-B56) & (100-299) or (300, A01-Z99) or (400-999)",
	"214", "Chippewa alone (B67-B99)",
	"215", "Chippewa alone or in any combination (B67-B99) & (100-299) or (300, A01-Z99) or (400-999)",
	"216", "Choctaw alone (C08-C16)",
	"217", "Choctaw alone or in any combination (C08-C16) & (100-299) or (300, A01-Z99) or (400-999)",
	"218", "Colville alone (C35-C38)",
	"219", "Colville alone or in any combination (C35-C38) & (100-299) or (300, A01-Z99) or (400-999)",
	"220", "Comanche alone (C39-C43)",
	"221", "Comanche alone or in any combination (C39-C43) & (100-299) or (300, A01-Z99) or (400-999)",
	"222", "Cree alone (C59-C63)",
	"223", "Cree alone or in any combination (C59-C63) & (100-299) or (300, A01-Z99) or (400-999)",
	"224", "Creek alone (C64-C80)",
	"225", "Creek alone or in any combination (C64-C80) & (100-299) or (300, A01-Z99) or (400-999)",
	"226", "Crow alone (C83-C86)",
	"227", "Crow alone or in any combination (C83-C86) & (100-299) or (300, A01-Z99) or (400-999)",
	"228", "Delaware alone (C93-D04)",
	"229", "Delaware alone or in any combination (C93-D04) & (100-299) or (300, A01-Z99) or (400-999)",
	"232", "Houma alone (D78-D86)",
	"233", "Houma alone or in any combination (D78-D86) & (100-299) or (300, A01-Z99) or (400-999)",
	"234", "Iroquois alone (D93-E09)",
	"235", "Iroquois alone or in any combination (D93-E09) & (100-299) or (300, A01-Z99) or (400-999)",
	"236", "Kiowa alone (E30-E36)",
	"237", "Kiowa alone or in any combination (E30-E36) & (100-299) or (300, A01-Z99) or (400-999)",
	"240", "Lumbee alone (E78-E83)",
	"241", "Lumbee alone or in any combination (E78-E83) & (100-299) or (300, A01-Z99) or (400-999)",
	"242", "Menominee alone (F11-F14)",
	"243", "Menominee alone or in any combination (F11-F14) & (100-299) or (300, A01-Z99) or (400-999)",
	"244", "Navajo alone (F62-F70)",
	"245", "Navajo alone or in any combination (F62-F70) & (100-299) or (300, A01-Z99) or (400-999)",
	"246", "Osage alone (G04-G09)",
	"247", "Osage alone or in any combination (G04-G09) & (100-299) or (300, A01-Z99) or (400-999)",
	"248", "Ottawa alone (G14-G22)",
	"249", "Ottawa alone or in any combination (G14-G22) & (100-299) or (300, A01-Z99) or (400-999)",
	"250", "Paiute alone (G23-G49)",
	"251", "Paiute alone or in any combination (G23-G49) & (100-299) or (300, A01-Z99) or (400-999)",
	"252", "Pima alone (G84-G91)",
	"253", "Pima alone or in any combination (G84-G91) & (100-299) or (300, A01-Z99) or (400-999)",
	"254", "Potawatomi alone (H21-H33)",
	"255", "Potawatomi alone or in any combination (H21-H33) & (100-299) or (300, A01-Z99) or (400-999)",
	"258", "Puget Sound Salish alone (H70-H92)",
	"259", "Puget Sound Salish alone or in any combination (H70-H92) & (100-299) or (300, A01-Z99) or (400-999)",
	"260", "Seminole alone (J47-J57)",
	"261", "Seminole alone or in any combination (J47-J57) & (100-299) or (300, A01-Z99) or (400-999)",
	"262", "Shoshone alone (J81-J92)",
	"263", "Shoshone alone or in any combination (J81-J92) & (100-299) or (300, A01-Z99) or (400-999)",
	"270", "Ute alone (L06-L14)",
	"271", "Ute alone or in any combination (L06-L14) & (100-299) or (300, A01-Z99) or (400-999)",
	"272", "Yakama alone (L79-L84)",
	"273", "Yakama alone or in any combination (L79-L84) & (100-299) or (300, A01-Z99) or (400-999)",
	"274", "Yaqui alone (L91-L99)",
	"275", "Yaqui alone or in any combination (L91-L99) & (100-299) or (300, A01-Z99) or (400-999)",
	"276", "Yuman alone (M22-M33)",
	"277", "Yuman alone or in any combination (M22-M33) & (100-299) or (300, A01-Z99) or (400-999)",
	"278", "American Indian tribes, specified, alone (A01-M38, T01-Z99)",
	"279", "Arapaho alone (A24-A33)",
	"280", "Assiniboine Sioux alone (A38-A44)",
	"281", "Canadian and French American Indian alone (T01-V23)",
	"282", "Central American Indian alone (V24-V83)",
	"285", "Eastern Tribes alone (D20-D26, D28-D41)",
	"286", "Hopi alone (D74-D75)",
	"288", "Mexican American Indian alone (V84-W66)",
	"295", "Shawnee alone (J66-J73)",
	"296", "South American Indian alone (W67-X24)",
	"297", "Spanish American Indian alone (X25-Z99)",
	"320", "Cherokee alone (B21-B39)",
	"321", "Pueblo alone (H38, H40, H42-H65)",
	"322", "Sioux alone (K16-K21, K23-K53)",
	"323", "Tohono O'Odham alone (K78-K86)",
	"324", "Tlingit-Haida alone (N28-N55, N59-N66)",
	"325", "Cherokee alone or in any combination (B21-B39) & (100-299) or (300, A01-Z99) or (400-999)",
	"326", "Pueblo alone or in any combination (H38, H40, H42-H65) & (100-299) or (300, A01-Z99) or (400-999)",
	"327", "Sioux alone or in any combination (K16-K21, K23-K53) & (100-299) or (300, A01-Z99) or (400-999)",
	"328", "Tohono O'Odham alone or in any combination (K78-K86) & (100-299) or (300, A01-Z99) or (400-999)",
	"329", "Tlingit-Haida alone or in any combination (N28-N55, N59-N66) & (100-299) or (300, A01-Z99) or (400-999)",
	"400", "Hispanic or Latino (of any race) (200-299)",
	"401", "Mexican (210-220)",
	"402", "Puerto Rican (260-269)",
	"403", "Cuban (270-274)",
	"404", "Other Hispanic or Latino (200-209, 221-259, 275-299)",
	"405", "Dominican (Dominican Republic) (275-279)",
	"406", "Central American (excludes Mexican) (221-230)",
	"407", "Costa Rican (221)",
	"408", "Guatemalan (222)",
	"409", "Honduran (223)",
	"410", "Nicaraguan (224)",
	"411", "Panamanian (225)",
	"412", "Salvadoran (226)",
	"413", "South American (231-249)",
	"414", "Argentinean (231)",
	"415", "Bolivian (232)",
	"416", "Chilean (233)",
	"417", "Colombian (234)",
	"418", "Ecuadorian (235)",
	"419", "Paraguayan (236)",
	"420", "Peruvian (237)",
	"421", "Uruguayan (238)",
	"422", "Venezuelan (239)",
	"423", "Spaniard (200-209)",
	"450", "Not Hispanic or Latino",
	"451", "White alone, not Hispanic or Latino",
	"452", "White alone or in combination with one or more other races, not Hispanic or Latino",
	"453", "Black or African American alone, not Hispanic or Latino",
	"454", "Black or African American alone or in combination with one or more other races, not Hispanic or Latino",
	"455", "American Indian and Alaska Native alone, not Hispanic or Latino",
	"456", "American Indian and Alaska Native alone or in combination with one or more other races, not Hispanic or Latino",
	"457", "Asian alone, not Hispanic or Latino",
	"458", "Asian alone or in combination with one or more other races, not Hispanic or Latino",
	"459", "Native Hawaiian and Other Pacific Islander alone, not Hispanic or Latino",
	"460", "Native Hawaiian and Other Pacific Islander alone or in combination with one or more other races, not Hispanic or Latino",
	"461", "Some Other Race alone, not Hispanic or Latino",
	"462", "Some Other Race alone or in combination with one or more other races, not Hispanic or Latino",
	"463", "Two or More Races, not Hispanic or Latino",
	"464", "White alone, Hispanic or Latino",
	"465", "White alone or in combination with one or more other races, Hispanic or Latino",
	"466", "Black or African American alone, Hispanic or Latino",
	"467", "Black or African American alone or in combination with one or more other races, Hispanic or Latino",
	"468", "American Indian and Alaska Native alone, Hispanic or Latino",
	"469", "American Indian and Alaska Native alone or in combination with one or more other races, Hispanic or Latino",
	"470", "Asian alone, Hispanic or Latino",
	"471", "Asian alone or in combination with one or more other races, Hispanic or Latino",
	"472", "Native Hawaiian and Other Pacific Islander alone, Hispanic or Latino",
	"473", "Native Hawaiian and Other Pacific Islander alone or in combination with one or more other races, Hispanic or Latino",
	"474", "Some Other Race alone, Hispanic or Latino",
	"475", "Some Other Race alone or in combination with one or more other races, Hispanic or Latino",
	"476", "Two or More Races, Hispanic or Latino",
	"477", "Eastern Tribes alone or in any combination (D20-D26, D28-D41) & (100-299) or (300, A01-Z99) or (400-999)",
	"478", "Hopi alone or in any combination (D74-D75) & (100-299) or (300, A01-Z99) or (400-999)",
	"479", "Luiseno alone or in any combination (E66-E77) & (100-299) or (300, A01-Z99) or (400-999)",
	"480", "Mexican American Indian alone or in any combination (V84-W66) & (100-299) or (300, A01-Z99) or (400-999)",
	"481", "Miami alone or in any combination (F17-F23) & (100-299) or (300, A01-Z99) or (400-999)",
	"482", "Micmac alone or in any combination (F27-F30) & (100-299) or (300, A01-Z99) or (400-999)",
	"483", "Oneida Tribe alone or in any combination (F99) & (100-299) or (300, A01-Z99) or (400-999)",
	"484", "Pomo alone or in any combination (G99-H14, H66-H69, H93-H98) & (100-299) or (300, A01-Z99) or (400-999)",
	"485", "Sac and Fox alone or in any combination (J19-J27) & (100-299) or (300, A01-Z99) or (400-999)",
	"486", "Salish and Kootenai alone or in any combination (J35-J37) & (100-299) or (300, A01-Z99) or (400-999)",
	"487", "Shawnee alone or in any combination (J66-J73) & (100-299) or (300, A01-Z99) or (400-999)",
	"488", "South American Indian alone or in any combination (W67-X24) & (100-299) or (300, A01-Z99) or (400-999)",
	"489", "Spanish American Indian alone or in any combination (X25-Z99) & (100-299) or (300, A01-Z99) or (400-999)",
	"490", "Three Affiliated Tribes of North Dakota alone or in any combination (D45-D48) & (100-299) or (300, A01-Z99) or (400-999)",
	"493", "Alaska Native tribes, specified, alone or in any combination (M52-R98, S01-S99) & (100-299) or (300, A01-Z99) or (400-999)",
	"494", "Inupiat alone or in any combination (N67-P29, P33-P37) & (100-299) or (300, A01-Z99) or (400-999)",
	"495", "Tsimshian alone or in any combination (N56-N58) & (100-299) or (300, A01-Z99) or (400-999)",
	"496", "Yup'ik alone or in any combination (P30-P32, P38-R10) & (100-299) or (300, A01-Z99) or (400-999)",
	"598", "Three or more races with Some Other Race",
	"599", "Three or more races without Some Other Race"
)
# ff = sprintf("%s/%s", src_path, "Iterations_list.csv")
# sf2_2010_iterations = read_csv(ff, col_types = cols(`SORT ID` = col_integer())) %>%
#	filter(!is.na(`Iteration Code`))
dest_file = sprintf("%s/%s.rda", dest_path, "sf2_2010_iterations")
save(sf2_2010_iterations, file = dest_file)

# ----- Segments: definitions for the 11 types of data files -----
segment01_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"PCT0010001")
segment02_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"PCT0020001", "PCT0020002", "PCT0020003", "PCT0020004", "PCT0020005",
	"PCT0020006")
segment03_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"PCT0030001", "PCT0030002", "PCT0030003", "PCT0030004", "PCT0030005",
	"PCT0030006", "PCT0030007", "PCT0030008", "PCT0030009", "PCT0030010",
	"PCT0030011", "PCT0030012", "PCT0030013", "PCT0030014", "PCT0030015",
	"PCT0030016", "PCT0030017", "PCT0030018", "PCT0030019", "PCT0030020",
	"PCT0030021", "PCT0030022", "PCT0030023", "PCT0030024", "PCT0030025",
	"PCT0030026", "PCT0030027", "PCT0030028", "PCT0030029", "PCT0030030",
	"PCT0030031", "PCT0030032", "PCT0030033", "PCT0030034", "PCT0030035",
	"PCT0030036", "PCT0030037", "PCT0030038", "PCT0030039", "PCT0030040",
	"PCT0030041", "PCT0030042", "PCT0030043", "PCT0030044", "PCT0030045",
	"PCT0030046", "PCT0030047", "PCT0030048", "PCT0030049", "PCT0030050",
	"PCT0030051", "PCT0030052", "PCT0030053", "PCT0030054", "PCT0030055",
	"PCT0030056", "PCT0030057", "PCT0030058", "PCT0030059", "PCT0030060",
	"PCT0030061", "PCT0030062", "PCT0030063", "PCT0030064", "PCT0030065",
	"PCT0030066", "PCT0030067", "PCT0030068", "PCT0030069", "PCT0030070",
	"PCT0030071", "PCT0030072", "PCT0030073", "PCT0030074", "PCT0030075",
	"PCT0030076", "PCT0030077", "PCT0030078", "PCT0030079", "PCT0030080",
	"PCT0030081", "PCT0030082", "PCT0030083", "PCT0030084", "PCT0030085",
	"PCT0030086", "PCT0030087", "PCT0030088", "PCT0030089", "PCT0030090",
	"PCT0030091", "PCT0030092", "PCT0030093", "PCT0030094", "PCT0030095",
	"PCT0030096", "PCT0030097", "PCT0030098", "PCT0030099", "PCT0030100",
	"PCT0030101", "PCT0030102", "PCT0030103", "PCT0030104", "PCT0030105",
	"PCT0030106", "PCT0030107", "PCT0030108", "PCT0030109", "PCT0030110",
	"PCT0030111", "PCT0030112", "PCT0030113", "PCT0030114", "PCT0030115",
	"PCT0030116", "PCT0030117", "PCT0030118", "PCT0030119", "PCT0030120",
	"PCT0030121", "PCT0030122", "PCT0030123", "PCT0030124", "PCT0030125",
	"PCT0030126", "PCT0030127", "PCT0030128", "PCT0030129", "PCT0030130",
	"PCT0030131", "PCT0030132", "PCT0030133", "PCT0030134", "PCT0030135",
	"PCT0030136", "PCT0030137", "PCT0030138", "PCT0030139", "PCT0030140",
	"PCT0030141", "PCT0030142", "PCT0030143", "PCT0030144", "PCT0030145",
	"PCT0030146", "PCT0030147", "PCT0030148", "PCT0030149", "PCT0030150",
	"PCT0030151", "PCT0030152", "PCT0030153", "PCT0030154", "PCT0030155",
	"PCT0030156", "PCT0030157", "PCT0030158", "PCT0030159", "PCT0030160",
	"PCT0030161", "PCT0030162", "PCT0030163", "PCT0030164", "PCT0030165",
	"PCT0030166", "PCT0030167", "PCT0030168", "PCT0030169", "PCT0030170",
	"PCT0030171", "PCT0030172", "PCT0030173", "PCT0030174", "PCT0030175",
	"PCT0030176", "PCT0030177", "PCT0030178", "PCT0030179", "PCT0030180",
	"PCT0030181", "PCT0030182", "PCT0030183", "PCT0030184", "PCT0030185",
	"PCT0030186", "PCT0030187", "PCT0030188", "PCT0030189", "PCT0030190",
	"PCT0030191", "PCT0030192", "PCT0030193", "PCT0030194", "PCT0030195",
	"PCT0030196", "PCT0030197", "PCT0030198", "PCT0030199", "PCT0030200",
	"PCT0030201", "PCT0030202", "PCT0030203", "PCT0030204", "PCT0030205",
	"PCT0030206", "PCT0030207", "PCT0030208", "PCT0030209", "PCT0040001",
	"PCT0040002", "PCT0040003")
segment04_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"PCT0050001", "PCT0050002", "PCT0050003", "PCT0050004", "PCT0050005",
	"PCT0050006", "PCT0050007", "PCT0050008", "PCT0050009", "PCT0050010",
	"PCT0050011", "PCT0050012", "PCT0050013", "PCT0050014", "PCT0050015",
	"PCT0050016", "PCT0050017", "PCT0050018", "PCT0050019", "PCT0050020",
	"PCT0050021", "PCT0050022", "PCT0050023", "PCT0050024", "PCT0050025",
	"PCT0050026", "PCT0050027", "PCT0050028", "PCT0050029", "PCT0050030",
	"PCT0050031", "PCT0050032", "PCT0050033", "PCT0050034", "PCT0050035",
	"PCT0050036", "PCT0050037", "PCT0050038", "PCT0050039", "PCT0050040",
	"PCT0050041", "PCT0050042", "PCT0050043", "PCT0050044", "PCT0050045",
	"PCT0050046", "PCT0050047", "PCT0050048", "PCT0050049", "PCT0060001",
	"PCT0060002", "PCT0060003", "PCT0070001", "PCT0070002", "PCT0070003",
	"PCT0080001", "PCT0080002", "PCT0080003", "PCT0080004", "PCT0080005",
	"PCT0080006", "PCT0080007", "PCT0080008", "PCT0080009", "PCT0090001",
	"PCT0090002", "PCT0090003", "PCT0090004", "PCT0090005", "PCT0090006",
	"PCT0090007", "PCT0090008", "PCT0090009", "PCT0090010", "PCT0090011",
	"PCT0090012", "PCT0090013", "PCT0090014", "PCT0090015", "PCT0090016",
	"PCT0090017", "PCT0090018", "PCT0090019", "PCT0100001", "PCT0100002",
	"PCT0100003", "PCT0100004", "PCT0100005", "PCT0100006", "PCT0100007",
	"PCT0100008", "PCT0100009", "PCT0100010", "PCT0100011", "PCT0100012",
	"PCT0100013", "PCT0100014", "PCT0100015", "PCT0100016", "PCT0100017",
	"PCT0100018", "PCT0100019", "PCT0100020", "PCT0100021", "PCT0100022",
	"PCT0100023", "PCT0100024", "PCT0100025", "PCT0100026", "PCT0100027",
	"PCT0100028", "PCT0100029", "PCT0100030", "PCT0100031", "PCT0100032",
	"PCT0100033", "PCT0100034", "PCT0110001", "PCT0110002", "PCT0110003",
	"PCT0110004", "PCT0110005", "PCT0110006", "PCT0110007", "PCT0110008",
	"PCT0110009", "PCT0110010", "PCT0110011", "PCT0110012", "PCT0110013",
	"PCT0110014", "PCT0110015", "PCT0110016", "PCT0110017", "PCT0110018",
	"PCT0110019", "PCT0110020", "PCT0110021", "PCT0110022", "PCT0110023",
	"PCT0110024", "PCT0110025", "PCT0110026", "PCT0110027", "PCT0110028",
	"PCT0110029", "PCT0110030", "PCT0110031", "PCT0120001", "PCT0120002",
	"PCT0120003", "PCT0120004", "PCT0120005", "PCT0120006", "PCT0120007",
	"PCT0120008", "PCT0120009", "PCT0120010", "PCT0120011", "PCT0120012",
	"PCT0120013", "PCT0120014", "PCT0120015", "PCT0120016", "PCT0120017",
	"PCT0120018", "PCT0120019", "PCT0120020", "PCT0120021", "PCT0130001",
	"PCT0130002", "PCT0130003", "PCT0130004", "PCT0130005", "PCT0130006",
	"PCT0130007", "PCT0130008", "PCT0130009", "PCT0130010", "PCT0130011",
	"PCT0130012", "PCT0130013", "PCT0130014", "PCT0130015", "PCT0140001",
	"PCT0140002", "PCT0140003", "PCT0140004", "PCT0140005", "PCT0140006",
	"PCT0140007", "PCT0140008", "PCT0140009", "PCT0140010", "PCT0140011",
	"PCT0150001", "PCT0150002", "PCT0150003", "PCT0150004", "PCT0150005",
	"PCT0150006", "PCT0150007", "PCT0150008", "PCT0150009", "PCT0150010",
	"PCT0150011", "PCT0160001", "PCT0160002", "PCT0160003", "PCT0160004",
	"PCT0160005", "PCT0160006", "PCT0160007", "PCT0160008", "PCT0160009",
	"PCT0160010", "PCT0160011", "PCT0170001", "PCT0170002", "PCT0170003",
	"PCT0180001", "PCT0180002", "PCT0180003")
segment05_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"PCT0190001", "PCT0190002", "PCT0190003", "PCT0190004", "PCT0190005",
	"PCT0190006", "PCT0190007", "PCT0190008", "PCT0190009", "PCT0190010",
	"PCT0190011", "PCT0190012", "PCT0190013", "PCT0190014", "PCT0190015",
	"PCT0190016", "PCT0190017", "PCT0190018", "PCT0190019", "PCT0190020",
	"PCT0190021", "PCT0190022", "PCT0190023", "PCT0190024", "PCT0190025",
	"PCT0190026", "PCT0190027", "PCT0190028", "PCT0190029", "PCT0190030",
	"PCT0190031", "PCT0190032", "PCT0190033", "PCT0190034", "PCT0200001",
	"PCT0200002", "PCT0200003", "PCT0200004", "PCT0200005", "PCT0200006",
	"PCT0200007", "PCT0200008", "PCT0200009", "PCT0200010", "PCT0200011",
	"PCT0200012", "PCT0200013", "PCT0200014", "PCT0200015", "PCT0200016",
	"PCT0210001", "PCT0210002", "PCT0210003", "PCT0210004", "PCT0210005",
	"PCT0210006", "PCT0210007", "PCT0210008", "PCT0210009", "PCT0210010",
	"PCT0210011", "PCT0210012", "PCT0210013", "PCT0210014", "PCT0210015",
	"PCT0210016", "PCT0210017", "PCT0210018", "PCT0210019", "PCT0210020",
	"PCT0210021", "PCT0210022", "PCT0210023", "PCT0210024", "PCT0210025",
	"PCT0210026", "PCT0220001", "PCT0220002", "PCT0220003", "PCT0220004",
	"PCT0220005", "PCT0220006", "PCT0220007", "PCT0220008", "PCT0220009",
	"PCT0220010", "PCT0220011", "PCT0220012", "PCT0220013", "PCT0220014",
	"PCT0220015", "PCT0220016", "PCT0220017", "PCT0220018", "PCT0220019",
	"PCT0220020", "PCT0220021", "PCT0220022", "PCT0220023", "PCT0220024",
	"PCT0220025", "PCT0220026", "PCT0220027", "PCT0220028", "PCT0230001",
	"PCT0230002", "PCT0230003", "PCT0230004", "PCT0230005", "PCT0230006",
	"PCT0230007", "PCT0230008", "PCT0230009", "PCT0230010", "PCT0230011",
	"PCT0230012", "PCT0230013", "PCT0240001", "PCT0240002", "PCT0240003",
	"PCT0240004", "PCT0240005", "PCT0240006", "PCT0240007", "PCT0240008",
	"PCT0240009", "PCT0240010", "PCT0240011", "PCT0240012", "PCT0240013",
	"PCT0240014", "PCT0240015", "PCT0240016", "PCT0250001", "PCT0250002",
	"PCT0250003", "PCT0250004", "PCT0250005", "PCT0250006", "PCT0250007",
	"PCT0250008", "PCT0250009", "PCT0250010", "PCT0250011", "PCT0250012",
	"PCT0250013", "PCT0250014", "PCT0250015", "PCT0250016", "PCT0250017",
	"PCT0250018", "PCT0250019", "PCT0250020", "PCT0250021", "PCT0250022",
	"PCT0250023", "PCT0250024", "PCT0250025", "PCT0250026", "PCT0250027",
	"PCT0250028", "PCT0250029", "PCT0250030", "PCT0250031", "PCT0250032",
	"PCT0250033", "PCT0250034", "PCT0250035", "PCT0250036", "PCT0250037",
	"PCT0250038", "PCT0250039", "PCT0250040", "PCT0250041", "PCT0250042",
	"PCT0250043", "PCT0250044", "PCT0250045", "PCT0260001", "PCT0260002",
	"PCT0260003", "PCT0260004", "PCT0260005", "PCT0260006", "PCT0260007",
	"PCT0270001", "PCT0270002", "PCT0270003", "PCT0270004", "PCT0270005",
	"PCT0270006", "PCT0270007", "PCT0270008", "PCT0270009", "PCT0270010",
	"PCT0270011", "PCT0270012", "PCT0270013", "PCT0270014", "PCT0270015",
	"PCT0270016", "PCT0270017", "PCT0270018", "PCT0280001", "PCT0280002",
	"PCT0280003", "PCT0280004", "PCT0280005", "PCT0280006", "PCT0280007",
	"PCT0280008", "PCT0280009", "PCT0280010", "PCT0280011", "PCT0280012",
	"PCT0280013", "PCT0280014", "PCT0280015", "PCT0280016", "PCT0280017",
	"PCT0280018", "PCT0280019", "PCT0280020", "PCT0280021", "PCT0280022",
	"PCT0280023", "PCT0290001", "PCT0300001", "PCT0300002", "PCT0300003",
	"PCT0310001", "PCT0310002", "PCT0310003")
segment06_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"PCT0320001", "PCT0320002", "PCT0320003", "PCT0320004", "PCT0320005",
	"PCT0320006", "PCT0320007", "PCT0320008", "PCT0320009", "PCT0320010",
	"PCT0320011", "PCT0320012", "PCT0320013", "PCT0320014", "PCT0320015",
	"PCT0320016", "PCT0320017", "PCT0320018", "PCT0320019", "PCT0320020",
	"PCT0330001", "PCT0330002", "PCT0330003", "PCT0330004", "PCT0330005",
	"PCT0330006", "PCT0330007", "PCT0330008", "PCT0330009", "PCT0330010",
	"PCT0330011", "PCT0330012", "PCT0330013", "PCT0330014", "PCT0330015",
	"PCT0330016", "PCT0330017", "PCT0330018", "PCT0330019", "PCT0330020",
	"PCT0340001", "PCT0340002", "PCT0340003", "PCT0340004", "PCT0340005",
	"PCT0340006", "PCT0340007", "PCT0340008", "PCT0340009", "PCT0340010",
	"PCT0340011", "PCT0340012", "PCT0340013", "PCT0340014", "PCT0340015",
	"PCT0340016", "PCT0340017", "PCT0340018", "PCT0340019", "PCT0340020",
	"PCT0350001", "PCT0350002", "PCT0350003", "PCT0350004", "PCT0350005",
	"PCT0350006", "PCT0360001", "PCT0360002", "PCT0360003", "PCT0360004",
	"PCT0360005", "PCT0360006", "PCT0360007", "PCT0360008", "PCT0360009",
	"PCT0360010", "PCT0360011", "PCT0360012", "PCT0360013", "PCT0360014",
	"PCT0360015", "PCT0370001", "PCT0370002", "PCT0370003", "PCT0370004",
	"PCT0370005", "PCT0370006", "PCT0370007", "PCT0370008", "PCT0370009",
	"PCT0370010", "PCT0370011", "PCT038 0001", "PCT038 0002", "PCT038 0003",
	"PCT038 0004", "PCT038 0005", "PCT038 0006", "PCT038 0007", "PCT038 0008",
	"PCT038 0009", "PCT038 0010", "PCT038 0011", "PCT038 0012", "PCT038 0013",
	"PCT038 0014", "PCT038 0015", "PCT038 0016", "PCT038 0017", "PCT038 0018",
	"PCT038 0019", "PCT038 0020", "PCT038 0021", "PCT038 0022", "PCT038 0023",
	"PCT038 0024", "PCT038 0025", "PCT038 0026", "PCT038 0027", "PCT038 0028",
	"PCT038 0029", "PCT038 0030", "PCT038 0031", "PCT038 0032")
segment07_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"PCT0390001", "PCT0390002", "PCT0390003", "PCT0390004", "PCT0390005",
	"PCT0390006", "PCT0390007", "PCT0390008", "PCT0390009", "PCT0390010",
	"PCT0390011", "PCT0390012", "PCT0390013", "PCT0390014", "PCT0390015",
	"PCT0390016", "PCT0390017", "PCT0390018", "PCT0390019", "PCT0390020",
	"PCT0390021", "PCT0390022", "PCT0390023", "PCT0390024", "PCT0390025",
	"PCT0390026", "PCT0390027", "PCT0390028", "PCT0390029", "PCT0390030",
	"PCT0390031", "PCT0390032", "PCT0390033", "PCT0390034", "PCT0390035",
	"PCT0390036", "PCT0390037", "PCT0390038", "PCT0390039", "PCT0390040",
	"PCT0390041", "PCT0390042", "PCT0390043", "PCT0390044", "PCT0390045",
	"PCT0390046", "PCT0390047", "PCT0390048", "PCT0390049", "PCT0390050",
	"PCT0390051", "PCT0390052", "PCT0390053", "PCT0390054", "PCT0390055",
	"PCT0390056", "PCT0390057", "PCT0390058", "PCT0390059", "PCT0390060",
	"PCT0390061", "PCT0390062", "PCT0390063", "PCT0390064", "PCT0390065",
	"PCT0390066", "PCT0390067", "PCT0390068", "PCT0390069", "PCT0390070",
	"PCT0390071", "PCT0390072", "PCT0390073", "PCT0390074", "PCT0390075",
	"PCT0390076", "PCT0390077", "PCT0390078", "PCT0390079", "PCT0390080",
	"PCT0390081", "PCT0390082", "PCT0390083", "PCT0390084", "PCT0390085",
	"PCT0390086", "PCT0390087", "PCT0390088", "PCT0390089", "PCT0390090",
	"PCT0390091", "PCT0390092", "PCT0390093", "PCT0390094", "PCT0390095",
	"PCT0390096", "PCT0390097", "PCT0390098", "PCT0390099", "PCT0390100",
	"PCT0390101", "PCT0390102", "PCT0390103", "PCT0390104", "PCT0390105",
	"PCT0390106", "PCT0390107", "PCT0390108", "PCT0390109", "PCT0390110",
	"PCT0390111", "PCT0390112", "PCT0390113", "PCT0390114", "PCT0390115",
	"PCT0390116", "PCT0390117", "PCT0390118", "PCT0390119", "PCT0390120",
	"PCT0390121", "PCT0390122", "PCT0390123", "PCT0390124", "PCT0390125",
	"PCT0390126", "PCT0390127", "PCT0390128", "PCT0390129", "PCT0390130",
	"PCT0390131", "PCT0390132", "PCT0390133", "PCT0390134", "PCT0390135",
	"PCT0390136", "PCT0390137", "PCT0390138", "PCT0390139", "PCT0390140",
	"PCT0390141", "PCT0390142", "PCT0390143", "PCT0390144", "PCT0390145",
	"PCT0390146", "PCT0390147", "PCT0390148", "PCT0390149", "PCT0390150",
	"PCT0390151", "PCT0390152", "PCT0390153", "PCT0390154", "PCT0390155",
	"PCT0390156", "PCT0390157", "PCT0390158", "PCT0390159", "PCT0390160",
	"PCT0390161", "PCT0390162", "PCT0390163", "PCT0390164", "PCT0390165",
	"PCT0390166", "PCT0390167", "PCT0390168", "PCT0390169", "PCT0390170",
	"PCT0390171", "PCT0390172", "PCT0390173", "PCT0390174", "PCT0390175",
	"PCT0390176", "PCT0390177", "PCT0390178", "PCT0390179", "PCT0390180",
	"PCT0390181", "PCT0390182", "PCT0390183", "PCT0390184", "PCT0390185",
	"PCT0390186", "PCT0390187", "PCT0390188", "PCT0390189", "PCT0390190",
	"PCT0390191", "PCT0390192", "PCT0390193", "PCT0390194", "PCT0390195",
	"PCT0400001", "PCT0400002", "PCT0400003", "PCT0410001", "PCT0410002",
	"PCT0410003", "PCT0420001", "PCT0420002", "PCT0420003", "PCT0430001",
	"PCT0430002", "PCT0430003", "PCT0440001", "PCT0440002", "PCT0440003",
	"PCT0450001", "PCT0450002", "PCT0450003", "PCT0460001", "PCT0460002",
	"PCT0460003", "PCT0470001", "PCT0470002", "PCT0470003")
segment08_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"PCO0010001", "PCO0010002", "PCO0010003", "PCO0010004", "PCO0010005",
	"PCO0010006", "PCO0010007", "PCO0010008", "PCO0010009", "PCO0010010",
	"PCO0010011", "PCO0010012", "PCO0010013", "PCO0010014", "PCO0010015",
	"PCO0010016", "PCO0010017", "PCO0010018", "PCO0010019", "PCO0010020",
	"PCO0010021", "PCO0010022", "PCO0010023", "PCO0010024", "PCO0010025",
	"PCO0010026", "PCO0010027", "PCO0010028", "PCO0010029", "PCO0010030",
	"PCO0010031", "PCO0010032", "PCO0010033", "PCO0010034", "PCO0010035",
	"PCO0010036", "PCO0010037", "PCO0010038", "PCO0010039", "PCO0020001",
	"PCO0020002", "PCO0020003", "PCO0020004", "PCO0020005", "PCO0020006",
	"PCO0020007", "PCO0020008", "PCO0020009", "PCO0020010", "PCO0020011",
	"PCO0020012", "PCO0020013", "PCO0020014", "PCO0020015", "PCO0020016",
	"PCO0020017", "PCO0020018", "PCO0020019", "PCO0020020", "PCO0020021",
	"PCO0020022", "PCO0020023", "PCO0020024", "PCO0020025", "PCO0020026",
	"PCO0020027", "PCO0020028", "PCO0020029", "PCO0020030", "PCO0020031",
	"PCO0020032", "PCO0020033", "PCO0020034", "PCO0020035", "PCO0020036",
	"PCO0020037", "PCO0020038", "PCO0020039", "PCO0030001", "PCO0030002",
	"PCO0030003", "PCO0030004", "PCO0030005", "PCO0030006", "PCO0030007",
	"PCO0030008", "PCO0030009", "PCO0030010", "PCO0030011", "PCO0030012",
	"PCO0030013", "PCO0030014", "PCO0030015", "PCO0030016", "PCO0030017",
	"PCO0030018", "PCO0030019", "PCO0030020", "PCO0030021", "PCO0030022",
	"PCO0030023", "PCO0030024", "PCO0030025", "PCO0030026", "PCO0030027",
	"PCO0030028", "PCO0030029", "PCO0030030", "PCO0030031", "PCO0030032",
	"PCO0030033", "PCO0040001", "PCO0040002", "PCO0040003", "PCO0040004",
	"PCO0040005", "PCO0040006", "PCO0040007", "PCO0040008", "PCO0040009",
	"PCO0040010", "PCO0040011", "PCO0040012", "PCO0040013", "PCO0040014",
	"PCO0040015", "PCO0050001", "PCO0050002", "PCO0050003", "PCO0050004",
	"PCO0050005", "PCO0050006", "PCO0050007", "PCO0050008", "PCO0050009",
	"PCO0050010", "PCO0050011", "PCO0050012", "PCO0050013", "PCO0050014",
	"PCO0050015", "PCO0050016", "PCO0050017", "PCO0050018", "PCO0050019",
	"PCO0050020", "PCO0050021", "PCO0050022", "PCO0050023", "PCO0050024",
	"PCO0050025", "PCO0050026", "PCO0050027", "PCO0050028", "PCO0050029",
	"PCO0050030", "PCO0050031", "PCO0060001", "PCO0060002", "PCO0060003",
	"PCO0060004", "PCO0060005", "PCO0060006", "PCO0060007", "PCO0060008",
	"PCO0060009", "PCO0060010", "PCO0060011", "PCO0060012", "PCO0060013",
	"PCO0060014", "PCO0060015", "PCO0060016", "PCO0060017", "PCO0060018",
	"PCO0060019", "PCO0060020", "PCO0060021", "PCO0060022", "PCO0060023",
	"PCO0060024", "PCO0060025", "PCO0060026", "PCO0060027", "PCO0060028",
	"PCO0060029", "PCO0060030", "PCO0060031", "PCO0060032", "PCO0060033",
	"PCO0060034", "PCO0060035", "PCO0060036", "PCO0060037", "PCO0060038",
	"PCO0060039", "PCO0070001", "PCO0070002", "PCO0070003", "PCO0070004",
	"PCO0070005", "PCO0070006", "PCO0070007", "PCO0070008", "PCO0070009",
	"PCO0070010", "PCO0070011", "PCO0070012", "PCO0070013", "PCO0070014",
	"PCO0070015", "PCO0070016", "PCO0070017", "PCO0070018", "PCO0070019",
	"PCO0070020", "PCO0070021", "PCO0070022", "PCO0070023", "PCO0070024",
	"PCO0070025", "PCO0070026", "PCO0070027", "PCO0070028", "PCO0070029",
	"PCO0070030", "PCO0070031", "PCO0070032", "PCO0070033", "PCO0070034",
	"PCO0070035", "PCO0070036", "PCO0070037", "PCO0070038", "PCO0070039")
segment09_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"PCO0080001", "PCO0080002", "PCO0080003", "PCO0080004", "PCO0080005",
	"PCO0080006", "PCO0080007", "PCO0080008", "PCO0080009", "PCO0080010",
	"PCO0080011", "PCO0080012", "PCO0080013", "PCO0080014", "PCO0080015",
	"PCO0080016", "PCO0080017", "PCO0080018", "PCO0080019", "PCO0080020",
	"PCO0080021", "PCO0080022", "PCO0080023", "PCO0080024", "PCO0080025",
	"PCO0090001", "PCO0090002", "PCO0090003", "PCO0090004", "PCO0090005",
	"PCO0090006", "PCO0090007", "PCO0090008", "PCO0090009", "PCO0090010",
	"PCO0090011", "PCO0090012", "PCO0090013", "PCO0090014", "PCO0090015",
	"PCO0090016", "PCO0090017", "PCO0090018", "PCO0090019", "PCO0090020",
	"PCO0090021", "PCO0090022", "PCO0090023", "PCO0090024", "PCO0090025",
	"PCO0100001", "PCO0100002", "PCO0100003", "PCO0100004", "PCO0100005",
	"PCO0100006", "PCO0100007", "PCO0100008", "PCO0100009", "PCO0100010",
	"PCO0100011", "PCO0100012", "PCO0100013", "PCO0100014", "PCO0100015",
	"PCO0100016", "PCO0100017", "PCO0100018", "PCO0100019", "PCO0100020",
	"PCO0100021", "PCO0100022", "PCO0100023", "PCO0100024", "PCO0100025",
	"PCO0100026", "PCO0100027", "PCO0100028", "PCO0100029", "PCO0100030",
	"PCO0100031", "PCO0100032", "PCO0100033", "PCO0100034", "PCO0100035",
	"PCO0100036", "PCO0100037", "PCO0100038", "PCO0100039")
segment10_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"HCT0010001", "HCT0010002", "HCT0010003", "HCT0010004", "HCT0010005",
	"HCT0010006")
segment11_fields = c("FILEID", "STUSAB", "CHARITER", "CIFSN", "LOGRECNO",
	"HCT0020001", "HCT0020002", "HCT0020003", "HCT0020004", "HCT0030001",
	"HCT0040001", "HCT0040002", "HCT0040003", "HCT0040004", "HCT0050001",
	"HCT0050002", "HCT0050003", "HCT0060001", "HCT0060002", "HCT0060003",
	"HCT0060004", "HCT0060005", "HCT0060006", "HCT0060007", "HCT0060008",
	"HCT0070001", "HCT0070002", "HCT0070003", "HCT0070004", "HCT0070005",
	"HCT0070006", "HCT0070007", "HCT0070008", "HCT0070009", "HCT0070010",
	"HCT0070011", "HCT0070012", "HCT0070013", "HCT0070014", "HCT0070015",
	"HCT0070016", "HCT0070017", "HCT0080001", "HCT0080002", "HCT0080003",
	"HCT0080004", "HCT0080005", "HCT0080006", "HCT0080007", "HCT0080008",
	"HCT0080009", "HCT0080010", "HCT0080011", "HCT0080012", "HCT0080013",
	"HCT0080014", "HCT0080015", "HCT0080016", "HCT0080017", "HCT0080018",
	"HCT0080019", "HCT0080020", "HCT0080021", "HCT0090001", "HCT0090002",
	"HCT0090003", "HCT0090004", "HCT0090005", "HCT0090006", "HCT0090007",
	"HCT0090008", "HCT0090009", "HCT0090010", "HCT0090011", "HCT0090012",
	"HCT0090013", "HCT0090014", "HCT0090015", "HCT0090016", "HCT0090017",
	"HCT0090018", "HCT0090019", "HCT0090020", "HCT0090021", "HCT0090022",
	"HCT0090023", "HCT0090024", "HCT0090025", "HCT0090026", "HCT0090027",
	"HCT0090028", "HCT0090029", "HCT0090030", "HCT0090031", "HCT0090032",
	"HCT0090033", "HCT0090034", "HCT0090035", "HCT0090036", "HCT0090037",
	"HCT0090038", "HCT0090039", "HCT0090040", "HCT0090041", "HCT0090042",
	"HCT0090043", "HCT0090044", "HCT0090045", "HCT0090046", "HCT0090047",
	"HCT0090048", "HCT0090049", "HCT0090050", "HCT0090051", "HCT0090052",
	"HCT0090053", "HCT0090054", "HCT0090055", "HCT0090056", "HCT0090057",
	"HCT0090058", "HCT0090059", "HCT0090060", "HCT0090061", "HCT0090062",
	"HCT0090063", "HCT0090064", "HCT0090065", "HCT0090066", "HCT0090067",
	"HCT0090068", "HCT0090069", "HCT0100001", "HCT0100002", "HCT0100003",
	"HCT0100004", "HCT0100005", "HCT0100006", "HCT0100007", "HCT0100008",
	"HCT0100009", "HCT0100010", "HCT0100011", "HCT0100012", "HCT0100013",
	"HCT0110001", "HCT0110002", "HCT0110003", "HCT0110004", "HCT0110005",
	"HCT0110006", "HCT0110007", "HCT0110008", "HCT0110009", "HCT0110010",
	"HCT0110011", "HCT0110012", "HCT0110013", "HCT0120001", "HCT0120002",
	"HCT0120003", "HCT0120004", "HCT0120005", "HCT0120006", "HCT0120007",
	"HCT0120008", "HCT0120009", "HCT0120010", "HCT0120011", "HCT0120012",
	"HCT0120013", "HCT0130001", "HCT0130002", "HCT0130003", "HCT0140001",
	"HCT0140002", "HCT0140003")

# Variable names in the vectors above are assumed to be in the correct order
# Note that the table name is a prefix in the variable name
sf2_2010_segments = rbind(
	tibble(FIELD = segment01_fields) %>% mutate(SEGMENT = "01", POSITION = row_number()),
	tibble(FIELD = segment02_fields) %>% mutate(SEGMENT = "02", POSITION = row_number()),
	tibble(FIELD = segment03_fields) %>% mutate(SEGMENT = "03", POSITION = row_number()),
	tibble(FIELD = segment04_fields) %>% mutate(SEGMENT = "04", POSITION = row_number()),
	tibble(FIELD = segment05_fields) %>% mutate(SEGMENT = "05", POSITION = row_number()),
	tibble(FIELD = segment06_fields) %>% mutate(SEGMENT = "06", POSITION = row_number()),
	tibble(FIELD = segment07_fields) %>% mutate(SEGMENT = "07", POSITION = row_number()),
	tibble(FIELD = segment08_fields) %>% mutate(SEGMENT = "08", POSITION = row_number()),
	tibble(FIELD = segment09_fields) %>% mutate(SEGMENT = "09", POSITION = row_number()),
	tibble(FIELD = segment10_fields) %>% mutate(SEGMENT = "10", POSITION = row_number()),
	tibble(FIELD = segment11_fields) %>% mutate(SEGMENT = "11", POSITION = row_number())
) %>% select(SEGMENT, POSITION, FIELD) %>%
	mutate(TABLE = case_when(
		startsWith(FIELD, "PCT") ~ substring(FIELD, 1, 6),
		startsWith(FIELD, "PCO") ~ substring(FIELD, 1, 6),
		startsWith(FIELD, "HCT") ~ substring(FIELD, 1, 6),
		TRUE ~ "HEAD"))

dest_file = sprintf("%s/%s.rda", dest_path, "sf2_2010_segments")
save(sf2_2010_segments, file = dest_file)

# ----- Tables: definitions of tables -----
sf2_2010_tables = tribble(
 ~NUMBER, ~DESCRIPTION,
	"PCT001", "TOTAL POPULATION [1]",
	"PCT002", "URBAN AND RURAL [6]",
	"PCT003", "SEX BY AGE [209]",
	"PCT004", "MEDIAN AGE BY SEX [3]  (1 expressed decimal)",
	"PCT005", "SEX BY AGE FOR THE POPULATION IN HOUSEHOLDS [49]",
	"PCT006", "POPULATION IN HOUSEHOLDS BY AGE (ITERATED BY RACE, HISPANIC OR LATINO ORIGIN, OR AMERICAN INDIAN OR ALASKA NATIVE TRIBE OR TRIBAL GROUPING OF THE HOUSEHOLDER) [3]",
	"PCT007", "AVERAGE HOUSEHOLD SIZE BY AGE [3]  (2 expressed decimals)",
	"PCT008", "HOUSEHOLD TYPE [9]",
	"PCT009", "HOUSEHOLD SIZE BY HOUSEHOLD TYPE BY PRESENCE OF OWN CHILDREN [19]",
	"PCT010", "HOUSEHOLDS BY PRESENCE OF PEOPLE UNDER 18 YEARS BY HOUSEHOLD TYPE BY AGE OF PEOPLE UNDER 18 YEARS [34]",
	"PCT011", "HOUSEHOLDS BY AGE OF HOUSEHOLDER BY HOUSEHOLD TYPE BY PRESENCE OF RELATED CHILDREN [31]",
	"PCT012", "HOUSEHOLD TYPE BY AGE OF HOUSEHOLDER [21]",
	"PCT013", "HOUSEHOLDS BY PRESENCE OF PEOPLE 60 YEARS AND OVER BY HOUSEHOLD TYPE [15]",
	"PCT014", "HOUSEHOLDS BY PRESENCE OF PEOPLE 60 YEARS AND OVER, HOUSEHOLD SIZE, AND HOUSEHOLD TYPE [11]",
	"PCT015", "HOUSEHOLDS BY PRESENCE OF PEOPLE 65 YEARS AND OVER, HOUSEHOLD SIZE, AND HOUSEHOLD TYPE [11]",
	"PCT016", "HOUSEHOLDS BY PRESENCE OF PEOPLE 75 YEARS AND OVER, HOUSEHOLD SIZE, AND HOUSEHOLD TYPE [11]",
	"PCT017", "PRESENCE OF MULTIGENERATIONAL HOUSEHOLDS [3]",
	"PCT018", "HOUSEHOLDS BY PRESENCE OF NONRELATIVES [3]",
	"PCT019", "HUSBAND-WIFE AND UNMARRIED-PARTNER HOUSEHOLDS BY SEX OF PARTNER BY PRESENCE OF RELATED AND OWN CHILDREN UNDER 18 YEARS [34]",
	"PCT020", "HOUSEHOLD TYPE BY HOUSEHOLD SIZE [16]",
	"PCT021", "HOUSEHOLD TYPE BY NUMBER OF PEOPLE UNDER 18 YEARS (EXCLUDING HOUSEHOLDERS, SPOUSES, AND UNMARRIED PARTNERS) [26]",
	"PCT022", "HOUSEHOLD TYPE BY RELATIONSHIP [28]",
	"PCT023", " HOUSEHOLD TYPE FOR THE POPULATION IN HOUSEHOLDS [13]",
	"PCT024", "HOUSEHOLD TYPE BY RELATIONSHIP FOR THE POPULATION UNDER 18 YEARS [16]",
	"PCT025", "HOUSEHOLD TYPE BY RELATIONSHIP BY AGE FOR THE POPULATION UNDER 18 YEARS [45]",
	"PCT026", "HOUSEHOLD TYPE FOR THE POPULATION UNDER 18 YEARS IN HOUSEHOLDS (EXCLUDING HOUSEHOLDERS, SPOUSES, AND UNMARRIED PARTNERS) [7]",
	"PCT027", "PRESENCE OF UNMARRIED PARTNER OF HOUSEHOLDER BY HOUSEHOLD TYPE FOR THE POPULATION UNDER 18 YEARS IN HOUSEHOLDS (EXCLUDING HOUSEHOLDERS, SPOUSES, AND UNMARRIED PARTNERS) [18]",
	"PCT028", "HOUSEHOLD TYPE BY RELATIONSHIP FOR THE POPULATION 65 YEARS AND OVER [23]",
	"PCT029", "FAMILIES [1]",
	"PCT030", "POPULATION IN FAMILIES BY AGE (ITERATED BY RACE, HISPANIC OR LATINO ORIGIN, OR AMERICAN INDIAN OR ALASKA NATIVE TRIBE OR TRIBAL GROUPING OF THE HOUSEHOLDER) [3]",
	"PCT031", "AVERAGE FAMILY SIZE BY AGE [3]  (2 expressed decimals)",
	"PCT032", "FAMILY TYPE BY PRESENCE AND AGE OF OWN CHILDREN [20]",
	"PCT033", "FAMILY TYPE BY PRESENCE AND AGE OF RELATED CHILDREN [20]",
	"PCT034", "FAMILY TYPE AND AGE FOR OWN CHILDREN UNDER 18 YEARS [20]",
	"PCT035", "AGE OF GRANDCHILDREN UNDER 18 YEARS LIVING WITH A GRANDPARENT HOUSEHOLDER [6]",
	"PCT036", "NONFAMILY HOUSEHOLDS BY SEX OF HOUSEHOLDER BY LIVING ALONE BY AGE OF HOUSEHOLDER [15]",
	"PCT037", "NONRELATIVES BY HOUSEHOLD TYPE [11]",
	"PCT038", "GROUP QUARTERS POPULATION BY GROUP QUARTERS TYPE [32]",
	"PCT039", "GROUP QUARTERS POPULATION BY SEX BY AGE BY GROUP QUARTERS TYPE [195]",
	"PCT040", "POPULATION SUBSTITUTED [3]",
	"PCT041", "ALLOCATION OF POPULATION ITEMS [3]",
	"PCT042", "ALLOCATION OF RACE [3]",
	"PCT043", "ALLOCATION OF HISPANIC OR LATINO ORIGIN [3]",
	"PCT044", "ALLOCATION OF SEX [3]",
	"PCT045", "ALLOCATION OF AGE [3]",
	"PCT046", "ALLOCATION OF RELATIONSHIP [3]",
	"PCT047", "ALLOCATION OF POPULATION ITEMS FOR THE POPULATION IN GROUP QUARTERS [3]",
	"PCO001", "GROUP QUARTERS POPULATION BY SEX BY AGE [39]",
	"PCO002", "GROUP QUARTERS POPULATION IN INSTITUTIONAL FACILITIES BY SEX BY AGE [39]",
	"PCO003", "GROUP QUARTERS POPULATION IN CORRECTIONAL FACILITIES FOR ADULTS BY SEX BY AGE [33]",
	"PCO004", "GROUP QUARTERS POPULATION IN JUVENILE FACILITIES BY SEX BY AGE [15]",
	"PCO005", "GROUP QUARTERS POPULATION IN NURSING FACILITIES/SKILLED-NURSING FACILITIES BY SEX BY AGE [31]",
	"PCO006", "GROUP QUARTERS POPULATION IN OTHER INSTITUTIONAL FACILITIES BY SEX BY AGE [39]",
	"PCO007", "GROUP QUARTERS POPULATION IN  NONINSTITUTIONAL FACILITIES BY SEX BY AGE [39]",
	"PCO008", "GROUP QUARTERS POPULATION IN COLLEGE/UNIVERSITY STUDENT HOUSING BY SEX BY AGE [25]",
	"PCO009", "GROUP QUARTERS POPULATION IN MILITARY QUARTERS BY SEX BY AGE [25]",
	"PCO010", "GROUP QUARTERS POPULATION IN OTHER NONINSTITUTIONAL FACILITIES BY SEX BY AGE [39]",
	"HCT001", "URBAN AND RURAL [6]",
	"HCT002", "TENURE [4]",
	"HCT003", "TOTAL POPULATION IN OCCUPIED HOUSING UNITS [1]",
	"HCT004", "TOTAL POPULATION IN OCCUPIED HOUSING UNITS BY TENURE [4]",
	"HCT005", "AVERAGE HOUSEHOLD SIZE OF OCCUPIED HOUSING UNITS BY TENURE [3]  (2 expressed decimals)",
	"HCT006", "HOUSEHOLD SIZE [8]",
	"HCT007", "TENURE BY HOUSEHOLD SIZE [17]",
	"HCT008", "TENURE BY AGE OF HOUSEHOLDER [21]",
	"HCT009", "TENURE BY HOUSEHOLD TYPE BY AGE OF HOUSEHOLDER [69]",
	"HCT010", "TENURE BY PRESENCE AND AGE OF OWN CHILDREN [13]",
	"HCT011", "TENURE BY PRESENCE AND AGE OF RELATED CHILDREN [13]",
	"HCT012", "TENURE BY PRESENCE AND AGE OF PEOPLE UNDER 18 YEARS BY HOUSEHOLD TYPE  (EXCLUDING HOUSEHOLDERS, SPOUSES, AND UNMARRIED PARTNERS) [13]",
	"HCT013", "OCCUPIED HOUSING UNITS SUBSTITUTED [3]",
	"HCT014", "ALLOCATION OF TENURE [3]"
)
dest_file = sprintf("%s/%s.rda", dest_path, "sf2_2010_tables")
save(sf2_2010_tables, file = dest_file)

# TBD: Do we still need this?
if (FALSE) {
	ff = sprintf("%s/%s", src_path, "SF2_GeoHeader.csv")
	sf2_2010_geoheader = read_csv(ff)
	dest_file = sprintf("%s/%s.rda", dest_path, "sf2_2010_geoheader")
	save(sf2_2010_geoheader, file = dest_file)
}

# TBD: Do we still need this?
if (FALSE) {
	ff = sprintf("%s/%s", src_path, "DataDictionary_NOTES.csv")
	sf2_2010_geoheader_dd_notes = read_csv(ff)
	dest_file = sprintf("%s/%s.rda", dest_path, "sf2_2010_geoheader_dd_notes")
	save(sf2_2010_geoheader_dd_notes, file = dest_file)
}

# TBD: Do we still need this?
if (FALSE) {
	ff = sprintf("%s/%s", src_path, "DataDictionary.csv")
	col_types = cols(SEGMENT = col_integer(), SORT_ID = col_integer())
	sf2_2010_geoheader_dd = read_csv(ff, col_types = col_types, trim_ws = FALSE)
	dest_file = sprintf("%s/%s.rda", dest_path, "sf2_2010_geoheader_dd")
	save(sf2_2010_geoheader_dd, file = dest_file)
}

# TBD: Do we still need this?
if (FALSE) {
	# Create a list of available tables, along with their segments
	table_segments = sf2_2010_geoheader_dd %>%
		filter(str_detect(`FIELD NAME`, "^Total")) %>%
		arrange(SORT_ID) %>%
		select(SEGMENT, NUMBER = TABLE)
	 table_descriptions = sf2_2010_geoheader_dd %>%
		filter(is.na(`FIELD CODE`)) %>%
		filter(!str_detect(`FIELD NAME`, "^Universe:")) %>%
		filter(str_detect(`FIELD NAME`, "\\[")) %>%
		filter(str_detect(`FIELD NAME`, "\\]")) %>%
		arrange(SORT_ID) %>%
		select(NUMBER = TABLE, DESCRIPTION = `FIELD NAME`)
	sf2_2010_tables = table_segments %>%
		inner_join(table_descriptions, by = c('NUMBER' = 'NUMBER'))
	dest_file = sprintf("%s/%s.rda", dest_path, "sf2_2010_tables")
	save(sf2_2010_tables, file = dest_file)
}
